
trial= ;


%%
FP1EEG = reRef_data(:,1,trial);
FPZEEG = reRef_data(:,2,trial);
FP2EEG = reRef_data(:,3,trial);
AF3EEG = reRef_data(:,4,trial);
AF4EEG = reRef_data(:,5,trial);
F11EEG = reRef_data(:,6,trial);
F7EEG = reRef_data(:,7,trial);
F5EEG = reRef_data(:,8,trial);
F3EEG = reRef_data(:,9,trial);
F1EEG = reRef_data(:,10,trial);
FZEEG = reRef_data(:,11,trial);
F2EEG = reRef_data(:,12,trial);
F4EEG = reRef_data(:,13,trial);
F6EEG = reRef_data(:,14,trial);
F8EEG = reRef_data(:,15,trial);
F12EEG = reRef_data(:,16,trial);
FT11EEG = reRef_data(:,17,trial);
FC5EEG = reRef_data(:,18,trial);
FC3EEG = reRef_data(:,19,trial);
FC1EEG = reRef_data(:,20,trial);
FCZEEG = reRef_data(:,21,trial);
FC2EEG = reRef_data(:,22,trial);
FC4EEG = reRef_data(:,23,trial);
FC6EEG = reRef_data(:,24,trial);
FT12EEG = reRef_data(:,25,trial);
T7EEG = reRef_data(:,26,trial);
C5EEG = reRef_data(:,27,trial);
C3EEG = reRef_data(:,28,trial);
C1EEG = reRef_data(:,29,trial);
CZEEG = reRef_data(:,30,trial);
C2EEG = reRef_data(:,31,trial);
C4EEG = reRef_data(:,32,trial);
C6EEG = reRef_data(:,33,trial);
T8EEG = reRef_data(:,34,trial);
TP7EEG = reRef_data(:,35,trial);
CP5EEG = reRef_data(:,36,trial);
CP3EEG = reRef_data(:,37,trial);
CP1EEG = reRef_data(:,38,trial);
CPZEEG = reRef_data(:,39,trial);
CP2EEG = reRef_data(:,40,trial);
CP4EEG = reRef_data(:,41,trial);
CP6EEG = reRef_data(:,42,trial);
TP8EEG = reRef_data(:,43,trial);
M1EEG = reRef_data(:,44,trial);
M2EEG = reRef_data(:,45,trial);
P7EEG = reRef_data(:,46,trial);
P5EEG = reRef_data(:,47,trial);
P3EEG = reRef_data(:,48,trial);
P1EEG = reRef_data(:,49,trial);
PZEEG = reRef_data(:,50,trial);
P2EEG = reRef_data(:,51,trial);
P4EEG = reRef_data(:,52,trial);
P6EEG = reRef_data(:,53,trial);
P8EEG = reRef_data(:,54,trial);
PO7EEG = reRef_data(:,55,trial);
PO3EEG = reRef_data(:,56,trial);
POZEEG = reRef_data(:,57,trial);
PO4EEG = reRef_data(:,58,trial);
PO8EEG = reRef_data(:,59,trial);
O1EEG = reRef_data(:,60,trial);
OZEEG = reRef_data(:,61,trial);
O2EEG = reRef_data(:,62,trial);
CB1EEG = reRef_data(:,63,trial);
CB2EEG = reRef_data(:,64,trial);
AFP1EEG = reRef_data(:,65,trial);
AFP2EEG = reRef_data(:,66,trial);
AF7EEG = reRef_data(:,67,trial);
AF5EEG = reRef_data(:,68,trial);
AFZEEG = reRef_data(:,69,trial);
AF6EEG = reRef_data(:,70,trial);
AF8EEG = reRef_data(:,71,trial);
AFF5HEEG = reRef_data(:,72,trial);
AFF3HEEG = reRef_data(:,73,trial);
AFF1HEEG = reRef_data(:,74,trial);
AFF2HEEG = reRef_data(:,75,trial);
AFF4HEEG = reRef_data(:,76,trial);
AFF6HEEG = reRef_data(:,77,trial);
F9EEG = reRef_data(:,78,trial);
F10EEG = reRef_data(:,79,trial);
FFT7HEEG = reRef_data(:,80,trial);
FFC5HEEG = reRef_data(:,81,trial);
FFC3HEEG = reRef_data(:,82,trial);
FFC1HEEG = reRef_data(:,83,trial);
FFC2HEEG = reRef_data(:,84,trial);
FFC4HEEG = reRef_data(:,85,trial);
FFC6HEEG = reRef_data(:,86,trial);
FFT8HEEG = reRef_data(:,87,trial);
FT9EEG = reRef_data(:,88,trial);
FT7EEG = reRef_data(:,89,trial);
FT8EEG = reRef_data(:,90,trial);
FT10EEG = reRef_data(:,91,trial);
FTT7HEEG = reRef_data(:,92,trial);
FCC5HEEG = reRef_data(:,93,trial);
FCC3HEEG = reRef_data(:,94,trial);
FCC1HEEG = reRef_data(:,95,trial);
FCC2HEEG = reRef_data(:,96,trial);
FCC4HEEG = reRef_data(:,97,trial);
FCC6HEEG = reRef_data(:,98,trial);
FTT8HEEG = reRef_data(:,99,trial);
TTP7HEEG = reRef_data(:,100,trial);
CCP5HEEG = reRef_data(:,101,trial);
CCP3HEEG = reRef_data(:,102,trial);
CCP1HEEG = reRef_data(:,103,trial);
CCP2HEEG = reRef_data(:,104,trial);
CCP4HEEG = reRef_data(:,105,trial);
CCP6HEEG = reRef_data(:,106,trial);
TTP8HEEG = reRef_data(:,107,trial);
TPP7HEEG = reRef_data(:,108,trial);
CPP5HEEG = reRef_data(:,109,trial);
CPP3HEEG = reRef_data(:,110,trial);
CPP1HEEG = reRef_data(:,111,trial);
CPP2HEEG = reRef_data(:,112,trial);
CPP4HEEG = reRef_data(:,113,trial);
CPP6HEEG = reRef_data(:,114,trial);
TPP8HEEG = reRef_data(:,115,trial);
P9EEG = reRef_data(:,116,trial);
P10EEG = reRef_data(:,117,trial);
PPO3HEEG = reRef_data(:,118,trial);
PPO1HEEG = reRef_data(:,119,trial);
PPO2HEEG = reRef_data(:,120,trial);
PPO4HEEG = reRef_data(:,121,trial);
PO9EEG = reRef_data(:,122,trial);
PO5EEG = reRef_data(:,123,trial);
PO1EEG = reRef_data(:,124,trial);
PO2EEG = reRef_data(:,125,trial);
PO6EEG = reRef_data(:,126,trial);
PO10EEG = reRef_data(:,127,trial);
CBZEEG = reRef_data(:,128,trial);
VEOGEEG = reRef_data(:,129,trial);
HEOGEEG = reRef_data(:,130,trial);
EMG1EEG = reRef_data(:,131,trial);
EMG2EEG = reRef_data(:,132,trial);
HL1EEG = reRef_data(:,133,trial);
HL2EEG = reRef_data(:,134,trial);
EMG3EEG = reRef_data(:,135,trial);
EMG4EEG = reRef_data(:,136,trial);
EMG5EEG = reRef_data(:,137,trial);
EMG6EEG = reRef_data(:,138,trial);
TRIGGEREEG = reRef_data(:,139,trial);

%%
FC1EEG; % Left to FCZ
FCZEEG; % the best location for SMA
FC2EEG; % Right to FCZ
%%
% x = X(:) ; 
% y = Y(:) ; 
% z = Z(:) ; 

P = [x' y' z'] ;
fid = fopen('test.xyz', 'wt');
fprintf(fid, [repmat('%.f\t', 1, size(P,2)-1) '%f\n'],P.');
fclose(fid)

%%
% plot out pow the 128 channels
AllchanNames={'FP1','FPZ','FP2','AF3','AF4','F11','F7','F5','F3','F1','FZ','F2','F4','F6','F8','F12','FT11','FC5','FC3','FC1','FCZ','FC2','FC4','FC6','FT12','T7','C5','C3','C1','CZ','C2','C4','C6','T8','TP7','CP5','CP3','CP1','CPZ','CP2','CP4','CP6','TP8','M1','M2','P7','P5','P3','P1','PZ','P2','P4','P6','P8','PO7','PO3','POZ','PO4','PO8','O1','OZ','O2','CB1','CB2','AFP1','AFP2','AF7','AF5','AFZ','AF6','AF8','AFF5H','AFF3H','AFF1H','AFF2H','AFF4H','AFF6H','F9','F10','FFT7H','FFC5H','FFC3H','FFC1H','FFC2H','FFC4H','FFC6H','FFT8H','FT9','FT7','FT8','FT10','FTT7H','FCC5H','FCC3H','FCC1H','FCC2H','FCC4H','FCC6H','FTT8H','TTP7H','CCP5H','CCP3H','CCP1H','CCP2H','CCP4H','CCP6H','TTP8H','TPP7H','CPP5H','CPP3H','CPP1H','CPP2H','CPP4H','CPP6H','TPP8H','P9','P10','PPO3H','PPO1H','PPO2H','PPO4H','PO9','PO5','PO1','PO2','PO6','PO10','CBZ','VEOG','HEOG','EMG1','EMG2','HL 1','HL 2','EMG3','EMG4','EMG5','EMG6','TRIGGER'};
% AllchanNames{1}

%% Calculate subplot coordinates for scalp map
cd /home/zhibin/Documents/GitHub/Motor_cordination/EEGanalysis
load('coordinates.mat');
X = [chanlocs128.X];
Y = [chanlocs128.Y];
Z = [chanlocs128.Z];
% labels = {'FP1','FPZ','FP2','AF3','AF4','F11','F7','F5','F3','F1','FZ','F2','F4','F6','F8','F12','FT11','FC5','FC3','FC1','FCZ','FC2','FC4','FC6','FT12','T7','C5','C3','C1','CZ','C2','C4','C6','T8','TP7','CP5','CP3','CP1','CPZ','CP2','CP4','CP6','TP8','M1','M2','P7','P5','P3','P1','PZ','P2','P4','P6','P8','PO7','PO3','POZ','PO4','PO8','O1','OZ','O2','CB1','CB2','AFP1','AFP2','AF7','AF5','AFZ','AF6','AF8','AFF5H','AFF3H','AFF1H','AFF2H','AFF4H','AFF6H','F9','F10','FFT7H','FFC5H','FFC3H','FFC1H','FFC2H','FFC4H','FFC6H','FFT8H','FT9','FT7','FT8','FT10','FTT7H','FCC5H','FCC3H','FCC1H','FCC2H','FCC4H','FCC6H','FTT8H','TTP7H','CCP5H','CCP3H','CCP1H','CCP2H','CCP4H','CCP6H','TTP8H','TPP7H','CPP5H','CPP3H','CPP1H','CPP2H','CPP4H','CPP6H','TPP8H','P9','P10','PPO3H','PPO1H','PPO2H','PPO4H','PO9','PO5','PO1','PO2','PO6','PO10','CBZ'};
labels = {'1-FP1', '2-FPZ', '3-FP2', '4-AF3', '5-AF4', '6-F11', '7-F7', '8-F5', '9-F3', '10-F1', '11-FZ', '12-F2', '13-F4', '14-F6', '15-F8', '16-F12', '17-FT11', '18-FC5', '19-FC3', '20-FC1', '21-FCZ', '22-FC2', '23-FC4', '24-FC6', '25-FT12', '26-T7', '27-C5', '28-C3', '29-C1', '30-CZ', '31-C2', '32-C4', '33-C6', '34-T8', '35-TP7', '36-CP5', '37-CP3', '38-CP1', '39-CPZ', '40-CP2', '41-CP4', '42-CP6', '43-TP8', '44-M1', '45-M2', '46-P7', '47-P5', '48-P3', '49-P1', '50-PZ', '51-P2', '52-P4', '53-P6', '54-P8', '55-PO7', '56-PO3', '57-POZ', '58-PO4', '59-PO8', '60-O1', '61-OZ', '62-O2', '63-CB1', '64-CB2', '65-AFP1', '66-AFP2', '67-AF7', '68-AF5', '69-AFZ', '70-AF6', '71-AF8', '72-AFF5H', '73-AFF3H', '74-AFF1H', '75-AFF2H', '76-AFF4H', '77-AFF6H', '78-F9', '79-F10', '80-FFT7H', '81-FFC5H', '82-FFC3H', '83-FFC1H', '84-FFC2H', '85-FFC4H', '86-FFC6H', '87-FFT8H', '88-FT9', '89-FT7', '90-FT8', '91-FT10', '92-FTT7H', '93-FCC5H', '94-FCC3H', '95-FCC1H', '96-FCC2H', '97-FCC4H', '98-FCC6H', '99-FTT8H', '100-TTP7H', '101-CCP5H', '102-CCP3H', '103-CCP1H', '104-CCP2H', '105-CCP4H', '106-CCP6H', '107-TTP8H', '108-TPP7H', '109-CPP5H', '110-CPP3H', '111-CPP1H', '112-CPP2H', '113-CPP4H', '114-CPP6H', '115-TPP8H', '116-P9', '117-P10', '118-PPO3H', '119-PPO1H', '120-PPO2H', '121-PPO4H', '122-PO9', '123-PO5', '124-PO1', '125-PO2', '126-PO6', '127-PO10', '128-CBZ'};

sort(Z) %just to examine
ZZ=((max(Z)-min(Z))*1.5-(Z-min(Z)))./((max(Z)-min(Z))*1.5); %Make higher Z smaller fraction
sort(ZZ) %just to examine

XXPLOT=(10*Y)*0.95;
YYPLOT=(10*X)*0.8;

XXPLOT=XXPLOT.*ZZ;
YYPLOT=YYPLOT.*ZZ;

XXPLOT=-1*XXPLOT;
YYPLOT=YYPLOT;

XXPLOT=XXPLOT*0.6;
YYPLOT=YYPLOT*0.7;

XXPLOT=XXPLOT+0.5;
YYPLOT=YYPLOT+0.5;

figure('units','normalized','outerposition',[0 0 1 1]);
plot(XXPLOT,YYPLOT,'r.');

% labels = {'FP1','FPZ','FP2','AF3','AF4','F11','F7','F5','F3','F1','FZ','F2','F4','F6','F8','F12','FT11','FC5','FC3','FC1','FCZ','FC2','FC4','FC6','FT12','T7','C5','C3','C1','CZ','C2','C4','C6','T8','TP7','CP5','CP3','CP1','CPZ','CP2','CP4','CP6','TP8','M1','M2','P7','P5','P3','P1','PZ','P2','P4','P6','P8','PO7','PO3','POZ','PO4','PO8','O1','OZ','O2','CB1','CB2','AFP1','AFP2','AF7','AF5','AFZ','AF6','AF8','AFF5H','AFF3H','AFF1H','AFF2H','AFF4H','AFF6H','F9','F10','FFT7H','FFC5H','FFC3H','FFC1H','FFC2H','FFC4H','FFC6H','FFT8H','FT9','FT7','FT8','FT10','FTT7H','FCC5H','FCC3H','FCC1H','FCC2H','FCC4H','FCC6H','FTT8H','TTP7H','CCP5H','CCP3H','CCP1H','CCP2H','CCP4H','CCP6H','TTP8H','TPP7H','CPP5H','CPP3H','CPP1H','CPP2H','CPP4H','CPP6H','TPP8H','P9','P10','PPO3H','PPO1H','PPO2H','PPO4H','PO9','PO5','PO1','PO2','PO6','PO10','CBZ'};;
text(XXPLOT,YYPLOT,labels,'VerticalAlignment','bottom','HorizontalAlignment','right');