# https://www.rdocumentation.org/packages/forecast/versions/8.16/topics/arfima

if(!require('forecast')) {
  install.packages('forecast')
  library('forecast')
}

library(fracdiff)
# https://www.rdocumentation.org/packages/fracdiff/versions/1.5-1/topics/fracdiff.sim
# Simulate long-memory time series from fractional ARIMA (P,d,q)
x <- fracdiff.sim( 100, ma=-.4, d=.5)$series

fit <- arfima(x)

fit <- arfima(x)


tsdisplay(residuals(fit))

## try out Error1 (not working)

Error1 <- c(0.217500000000200,0.171000000000049,0.151000000000067,0.148000000000138,-0.284999999999855,-0.429000000000087,-0.273999999999887,-0.144999999999982,-0.0315000000000509,-0.227499999999964,-0.478499999999940,0.0545000000001892,-0.00599999999985812,-0.105000000000018,-0.156999999999925,-0.0229999999999109,0.105000000000018,0.000500000000101863,-0.136999999999944,-0.233499999999822,-0.198999999999842,-0.185500000000047,-0.00250000000005457,0.184000000000196,0.0785000000000764,0.211000000000013,-0.0184999999999036,0.0855000000001382,0.244000000000142,0.150000000000091,-0.0329999999999018,-0.0625000000000000,-0.125499999999875,-0.168499999999995,0.0650000000000546,-0.000499999999874490,-0.124499999999898,-0.0679999999999836,-0.132000000000062,0.00600000000008549,0.102499999999964,-0.0724999999999909,0.0249999999998636,0.0595000000000709,0.202500000000100,-0.0434999999999945,-0.0539999999998599,-0.184999999999945,0.104500000000144,0.229000000000042,0.0540000000000873,-0.113499999999931,-0.111999999999853,-0.174999999999955,-0.137999999999920,-0.127500000000055,-0.114499999999907,-0.152000000000044,-0.243500000000040,-0.0534999999999855,-0.155999999999949,-0.170499999999947,-0.0414999999998145,-0.0279999999997926,-0.0225000000000364,0.135500000000093,-0.196500000000015,-0.306000000000040,-0.430499999999938,-0.160499999999956,-0.0734999999999673,-0.144999999999982,-0.153000000000020,-0.0409999999999400,-0.147500000000036,-0.219500000000153,0.0860000000000127,-0.00900000000001455,-0.152000000000044,0.208499999999958,-0.0529999999998836,-0.0595000000000709,0.0164999999999509,-0.105500000000120,-0.0610000000001492,-0.258000000000038,-0.318500000000086,-0.206500000000005,-0.0415000000000418,-0.110500000000002,-0.134999999999991,-0.120499999999993,0.0605000000000473,0.0750000000000455,-0.0579999999999927,-0.133499999999913,-0.251999999999953,-0.162000000000035,0.00500000000010914,-0.227000000000089,-0.384500000000116,-0.556000000000040,-0.198499999999967,-0.366500000000087,-0.0180000000000291,-0.201000000000022,-0.0115000000000691,0.0895000000000437,-0.227000000000089,-0.139499999999998,-0.286500000000160,-0.290999999999940,-0.128000000000156,-0.154500000000098,-0.162499999999909,-0.198000000000093,-0.151000000000067,-0.170000000000073,-0.131499999999960,0.186500000000024,-0.0464999999999236,0.0619999999998981,0.133499999999913,-0.0399999999999636,-0.0895000000000437,0.0779999999999745,-0.180499999999938,-0.387500000000046,-0.607500000000073,-0.239500000000135,-0.136999999999944,-0.180499999999938,-0.195000000000164,-0.237000000000080,-0.199500000000171,-0.0205000000000837,0.155999999999949,0.0834999999999582,0.119500000000016,0.119999999999891,-0.205500000000029,-0.119000000000142,-0.352000000000089,-0.429499999999962,-0.136000000000195,-0.120499999999993,-0.0640000000000782,0.0299999999999727,0.0924999999999727,-0.106500000000096,-0.314000000000078,0.134499999999889,0.00299999999992906,0.0749999999998181,0.106999999999971,-0.0275000000001455,0.188999999999851,-0.189000000000078,-0.116500000000087,0.00599999999985812,0.0929999999998472,0.0299999999999727,-0.218000000000075,-0.0860000000002401,0.0689999999999600,0.108499999999822,0.206499999999778,0.272499999999809,0.163999999999760,0.120499999999993,-0.257000000000062,-0.347500000000082,-0.0715000000000146,-0.103500000000167,-0.123500000000149,-0.217000000000098,0.107999999999947,-0.307500000000118,-0.160000000000082,-0.172000000000025,0.115499999999884,-0.167500000000018,-0.148500000000240,-0.131000000000086,0.0414999999998145,-0.152000000000044,-0.401000000000067,0.175499999999829,0.207999999999856,0.0789999999999509,0.132999999999811,0.173499999999876,0.112499999999955,0.171499999999924,0.141499999999951,0.139999999999873,0.214499999999816,0.272999999999911,0.143499999999904,0.0625000000000000,0.134999999999764,0.169499999999971,0.0774999999998727,0.230999999999767,0.204999999999927,0.204999999999927,-0.0789999999999509,0.103499999999940,-0.0334999999997763,-0.158499999999776,-0.109499999999798,-0.354999999999791,-0.209499999999935,-0.135499999999865,-0.113499999999931,-0.0489999999999782,0.0520000000001346,0.0330000000001292,-0.0659999999998036,-0.0754999999999200,-0.107499999999845,-0.261499999999842,-0.0904999999997926,0.119500000000016,0.102000000000089,0.112500000000182,-0.206500000000005,-0.423499999999876,-0.369999999999891,-0.306499999999915,0.0445000000001983,0.153000000000020,-0.165499999999838,-0.353999999999814,-0.380499999999984)

fitError1 <- arfima(Error1)

tsdisplay(residuals(fitError1))

##
